#   Курсовой проект
_________________________________________________
## Веб-сервисы
### Главная
#### В JSON-файл выводятся данные в формате:
Приветствие в формате — «Доброе утро» / «Добрый день» / «Добрый вечер» / «Доброй ночи» в зависимости от текущего времени. 

По каждой карте: 
* последние 4 цифры карты;
* общая сумма расходов;
* кешбэк (1 рубль на каждые 100 рублей).

Топ-5 транзакций по сумме платежа.

Курс валют.

Стоимость акций из S&P500.
## Сервисы
### Простой поиск
Пользователь передает строку для поиска, возвращается JSON-ответ со всеми транзакциями, содержащими запрос в описании или категории.
## Отсчеты
### Траты по категории
Функция возвращает траты по заданной категории.


**VIEWS информацмя 

Вот комментарии к функциям и краткая информация о них:

1. get_greeting(date_time_str_1): Эта функция принимает строку с датой и временем и возвращает приветствие в зависимости от времени суток. Это может быть полезно для создания персонализированных сообщений или уведомлений.

2. calculate_total_expenses(transactions): Функция вычисляет общую сумму расходов по списку транзакций. Она проходит через каждую транзакцию в списке и суммирует отрицательные значения, представляющие расходы.

3. read_transactions_xlsx(file_path): Эта функция читает данные о транзакциях из файла Excel. Она использует библиотеку Pandas для чтения данных и возвращает список словарей, где каждый словарь представляет одну транзакцию.

4. process_card_data(operations_1): Эта функция обрабатывает данные о картах из списка транзакций. Она создает словарь для каждой карты, где хранит последние четыре цифры номера карты, общую сумму потраченных средств и сумму кэшбэка.

5. top_transactions(reader): Функция возвращает список из пяти самых дорогих транзакций. Она сортирует транзакции по убыванию суммы и возвращает первые пять элементов списка.

6. get_currency_rate(currency): Эта функция получает курс валюты по отношению к рублю с использованием API. Она делает запрос к API с указанным кодом валюты и возвращает актуальный курс обмена.

7. get_stock_currency(stock): Функция получает текущую цену акции с помощью Yahoo Finance. Она использует библиотеку YFinance для получения цен на акции различных компаний.

В основной части кода происходит чтение данных о транзакциях, вычисление общей суммы расходов, обработка данных о картах, выборка самых дорогих транзакций, получение курсов валют и цен на акции, а затем сохранение всех данных в формате JSON в файл "operations_data.json".

Тесты этого модуля имеют 

** ОПИСАНИЕ МОДУЛЯ reports 

1. `read_transactions_xlsx(file_path: str) -> List[Dict]`

- Эта функция считывает данные о финансовых операциях из файла Excel (XLSX) с помощью библиотеки Pandas.
- Она принимает путь к файлу (`file_path`) в качестве аргумента.
- С помощью `pd.read_excel` считывает данные в DataFrame.
- Преобразует DataFrame в список словарей с помощью `to_dict("records")` и возвращает этот список.

2. `search_transactions(operations_1: list[dict[str, Any]], search_string_1: str) -> list[dict[str, Any]]`

- Функция выполняет фильтрацию списка словарей, представляющих финансовые операции.
- Она принимает два аргумента:
    - `operations_1`: Список словарей с данными о транзакциях.
    - `search_string_1`: Строка поиска.
- Функция использует `re.search` для поиска `search_string_1` в поле "description" каждой операции.
- Возвращает новый список, содержащий только операции, в описании которых найдена строка поиска.

3. `main` block:

- Считывает данные из Excel-файла с помощью `read_transactions_xlsx`.
- Выполняет поиск операций, содержащих "Магнит" в описании, с помощью `search_transactions`.
- Записывает отфильтрованные операции в JSON-файл "filtered_operations.json" с помощью `json.dump`. 
- Форматирует JSON-вывод для удобочитаемости с помощью `indent=4` и `ensure_ascii=False`.

инфа тестов этого модуля 

- `test_search_transactions`:  Этот тест проверяет, что функция `search_transactions` возвращает список, и что каждый элемент этого списка - это словарь. Он предполагает, что функция должна читать данные из файла `test_file.xlsx` и возвращать список словарей с операциями. 

- `test_search_other_transactions`: Этот тест проверяет, что функция `search_transactions` правильно фильтрует список операций. Он создает тестовый список операций (`self.operations`) и задает строку поиска (`self.search_string`). Затем тест проверяет, что функция возвращает список, содержащий две операции (те, что содержат "Магнит" в описании), и что в описании каждой операции из этого списка действительно присутствует строка поиска.


ОПИСАНИЕ МОДУЛЯ services 

Этот модуль предоставляет функцию `get_transactions_by_keyword`, которая позволяет осуществлять поиск транзакций по ключевому слову в описании или категории. 

Функция принимает один аргумент `search_term_2`, который является строкой для поиска. Она читает данные из файла "operations_mi.xls", фильтрует их на основе `search_term_2`, преобразует результаты в список словарей и возвращает JSON-строку с результатами поиска.

Если в результате фильтрации не найдено ни одной транзакции, будет возвращено сообщение об этом. 

Также функция сохраняет результаты поиска в файл "transactions_search_result.json".

В случае возникновения ошибок, таких как отсутствие файла или другие проблемы, функция возвращает соответствующие сообщения об ошибках в JSON-формате

ИНФА О ТЕСТАХ ЭТОГО МОДУЛЯ 

модуль содержит модульные тесты для функции get_transactions_by_keyword из модуля src/services. Тесты покрывают различные сценарии, такие как нахождение ключевого слова в описании или категории, обработку ошибки "файл не найден" и обработку других исключений, которые могут возникнуть в процессе работы. Тесты используют мокирование для моделирования данных и исключений, обеспечивая правильность и надежность функции get_transactions_by_keyword.


КЛАССЫ БЫЛИ ПРОСТО МНЕ УДОБНЕЕ , ЕСЛИ ТЕБЕ ОНИ НЕ ПОНРАВИТЬСЯ МЕЙБИ УДАЛЮ 
ЛИБО ОСТАВЛЮ , ТАК КАК Я ДУМАЮ ГЛАВНОЕ ЧТО БЫ ТЕСТЫ РАБОТАЛИ КАК ОНИ НА ПИСАНЫ И С ПОМОЩЬЮ ЧЕГО НЕ ВАЖНО 
